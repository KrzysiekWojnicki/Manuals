[1.2]
	3. Bind - Berkeley Internet Name Domain (server dns), A -IPv4 IP address, AAAA -IPv6 IP address, CNAME -Canonical name record (Alias)
	, SRV -Service record ,MX -Email server host names ,SOA -Authoritative information about a DNS zone
	4.server srv2.avantis.pl jest serverem autorytatynym , nie posiada ANSWER SECTION , innymi słowy to master który przechwuje
	orginalne odresy . Z kolei srv2mp.avantis.pl to slave który automatyczne updejtuje kopie domen.
	5.port 25 to port na Simple Mail Transfer Protocol (SMTP) , server nie obsługuje maili co uniemożliwia połączenie
	na porcie ssh 22 można się logować
	6.ping wysyła paczki Internet Control Message Protocol (ICMP) echo , i oczekuje odpowiedzi . server master może mieć
	firewall blokująca icmp ,albo icmp może być poprostu wyłączony na serverku
	co zapobiega ataką na server . można też zapingować maszyna "ping of death"
	7. 995 – POP3s , 22 – SSH , 143 – IMAP ,53 – DNS , 20-ftp(transfer) 21-ftp(przesył danych) ,80-http ,443-https
	8. sudo traceroute -T 212.77.98.9 -flaga "T" pomija firewall nałożone na porty udp i icmp , domyślnie
	ta opcja działa na porcie 80 ale można wybtać inny np: -p 25
	9. lokalnie mapujemy adresy w /etc/hosts a na serwerze dns w /etc/resolv.conf
	10.zdjęcie pt; odp_10
	11. unknown host -error generowany gdy docelowy komputer albo server nie odpowiada . Może to wskazywać że nazwa hosta
	podan przez urzytkownika nie istniej albo jest nizgodna z rekordami DNS . Błąd pojawić się może ze względu na
	ustwienia servera , niedostępność , albo niepoprawną nazwe
	host unreachable -rerror może wystąpić gdy pakiet nie przejdzie przez zdalną brame z powodu błędu w route-ingu
	Natomiast taki błąd w subnet-cie może być wywołany przez nie otrzymanie ARP request (Address Resolution Protocol)
	dla końcowego urządzenia . Bez arp request echo icmp nie może być wysłane .

[1.5]
	1.1.1 - total used free shared buff/cache available
	Mem: 15G 1,6G 12G 713M 1,6G 12G
	Swap: 15G 0B 15G
	1.1.2 - 11:06:27 up 3:15, 10 users, load average: 0,18, 0,27, 0,27
	1.1.3 - lsof | wc -l , u mnie 88834
	1.1.4 - cpu u mnie ok 20 według htop , na serverze srv2mp ok~ 50 %
	A najwięcej pamięci żre : "1662 krzysie+ 20 0 1447944 399388 320692 S 22,2 2,4 58:18.42 rambox"
	1.2.1 - start systemu 2018-07-31 19:28
	1.2.2 - w -userzy zalogowani , lsof | grep log
	1.2.3 - mpadmin space 1.8g cpu -5.0 mem 11.9 8477:45 java
	2.1 - du -sh /mnt/ --->15G /mnt/
	2.2 - 602M /usr/local/logs/mpservices/comm
	2.3 - > /log -wyczyszcze loga
	2.4 - kompresja pliku - logrotate .
	można też zrobić wiecj miejsca na dysku: sudo apt-get autoremove -czyszczenie z niepotzrebnych paczek
	ewentualnie: sudo apt-get autoclean -czyszczenie z nieaktualnych paczek
	można też zrbić syboliczny dla pliku log na inny (luźniejszy) dysk :
	ln -s /usr/local/logs/plik.log /ścieżka_do_wolnej_przestrzeni
	nawiększy log : du -a /usr/local/logs/ | sort -n -r | head -n 1 | grep -E 'log\b'
	3. SVN , Forbidden You don't have permission to access /repos/DNIU on this server. Apache/2.4.18 (Ubuntu) Server at svn.avantis.pl Port 443


[1.7]
	3. VirtualHost - to rodzaj hostowania na virtualnej infrastrukturze serverów , komputerów , pamięci ,usług .
	dedykowany może być osobom prywatnym albo organizacjom . Wirtualny host to także zdalne urządzenie
	które pozwala urzytkownikowy na hosting danych albo usług.
	Platforma Vhostingowa może być urzywana przez różnych urzytkowników albo dedykowana stronom www
	albo aplikacjom . Dostawca fizycznego servera zapewnia kontyngent zasobów dla każdego zarejestrowango
	kienta , który może być skalowalny w zależności od potrzeb.
	ProxyPass - dyrektywa mapująca ruch lokalnego URL-a na zdalny URL (server)
	ProxyPass /mirror/foo/ http://backend.example.com/
	mod_jk - moduł apacha do komunikacji kotenera tomcat z serverm web .
	dostępność hosta allow deny - zezwala , lub blokuje ruch od hostów lub daemonów
	odpowiednie instrukcje zapisać można w hosts.allow lub deny

[2.1] Messaging Platform

	1.
	Secondary platform jest zabezpieczeniem w wypadku gdyby primaty z jakiegoś powodu nie odpowieadł
	2.
	MySql , MP Config Pump , który kolejkuje sobie wszystkie
	 zadania krórych nie można w tej chwili wykonać , a w razie potrzeby przesyła je na platforme konkuręcji ktora zajmuje
	 się realizacją.
	3.
	Przed restartem - informujemy o konieczności : restartu Sebastian SK. Kasperek ,Piotr PS. Skonieczny ,Michał MB. Bogusz ,Mikolaj Klimek
	Pierwsze - zatrzymanie usług na srvmp , DC/OS , zatrzymanie MP
	Drugie - uruchamianie MP, uruchamianie usług, restartowanie tomcat-ów , restert secondary , mobistat ,RBSS
	Trzecie - czyszczenie : Zweryfikować wszystkie chcecki w nagiosie , Zweryfikować nie podniesione usługi ,
		Pamiętać o wysłaniu powiadomienia o zakończeniu awarii
	Cztery - weryfikacja usług :Nie wszystkie usługi podczas restartu mogły się prawidłowo podnieść.
		Aby namierzyć takie aplikacje mamy parę metod weryfikacji :
			Wchodzimy do konsoli jmx mp.core.MPCoreService i pod metodą listActivatedNotRegisteredServices() wykonujemy invoke.
			Sprawdzamy w mpconsole jakie aplikacje na samym dole są wylistowane i mają koło siebie pole deactivate.
			Sprawdzamy w mpconsole jakie aplikacje mają obok siebie ludzika o kolorze czerwonym bądź białym.
			Sprawdzamy w nagiosie check activated_not_registered.
			Sprawdzamy w panelu https://deploy.dcos.aws.avantis.pl czy są jakieś usługi o statusie innym niż Running.
			Sprawdzamy w nagiosie check marathon_apps.
		!!!--- Staramy się także doprowadzić, aby wszystkie checki nagiosowe znalazły się w stanie ok.
		Niedziałanie jakiejś strony www, przykładowo może być spowodowane błędami na usłudze znajdującej się na tomcacie,
		która nie może się prawidłowo podłączyć do backendu. Rozwiązaniem takiego przypadku może być najpierw zrestartowanie backendu,
		a potem ponowny restart tomcata, na którym znajduje się usługa. ---!!!

	4.
	jak padnie baza to MPCore nie wstanie (baza mysql)
	5.
	tocat i jmx dziłają na porcie 8080
	6.
	cd /usr/local/logs/mpcore/
	7.
	service-id -	101218
	service-description - Bramka do testow
	project-develope - Dawid Owczarczyk

[2.4] Routing
		Wiadomość weszła
		2018-12-07 15:56:33,199 | INFO  | RMI TCP Connection(8405)-10.168.202.75 | mp.service.Messaging                     | 44    | [] | Message delivered: id=33271160287, payload=TextSMS{sender='48606932401', recipient='7055', sendDate=Fri Dec 07 15:56:33 CET 2018, externalSendDate=null, deliveryDate=null, validityDate=null, payloadType=TEXT_SMS, operator=POLAND_ERA, masterOperator=POLAND_ERA, mobileTerminated=false, payloadDirection=IN, text='PZU', dataCodingScheme=3, partsNumber=1}, role=REQUEST

		2018-12-07 15:56:33,439 | INFO  | RMI TCP Connection(8405)-10.168.202.75 | service.edw.EdwContextExtension          | 43    | [] | [EDW] Message delivered and processed by service so creating EdwEvent, messageID=33271160287, payload=TextSMS{sender='48606932401', recipient='7055', sendDate=Fri Dec 07 15:56:33 CET 2018, externalSendDate=null, deliveryDate=null, validityDate=null, payloadType=TEXT_SMS, operator=POLAND_ERA, masterOperator=POLAND_ERA, mobileTerminated=false, payloadDirection=IN, text='PZU', dataCodingScheme=3, partsNumber=1}

	wiadomość wyszła - POLAND_ERA
	przeszła przez usługe - mps-pinapplegroup
	t-mobile - routing - usługa 	-	nr.telefonu  -  routing - status - traść - id
	26006   110233  mps-pinapplegroup       48531162757     7055    200     pzu     33270793022     07-DEC-18 01.48.48.317000 PM

	testowanie routingu
		26006   110185  mps-gratka-prod 48531162757     70908   200     grill   33271396183     07-DEC-18 05.11.39.579000 PM
		26006   110185  mps-gratka-prod 48531162757     70908   200     orlen   33271405391     07-DEC-18 05.15.13.192000 PM
		26006   110185  mps-gratka-prod 48531162757     70908   200     netto   33271410119     07-DEC-18 05.15.49.261000 PM
		26006   110185  mps-gratka-prod 48531162757     70908   200     shell   33271421614     07-DEC-18 05.16.58.859000 PM
		26006   110185  mps-gratka-prod 48531162757     70908   200     ruch    33271424491     07-DEC-18 05.17.16.801000 PM

		26002   3       tmobile-sms-gateway     70908   48696367096     200     110185  33271497220     07-DEC-18 05.37.00.173000 PM
		napisałem sobie smsa :D
[2.5]

Zapoznać się z zwartością MPS.MPSML_SERVICES oraz wskazać:
W którym conteinerze znajduje się mps-gratka-prod
	ODP: null - czyli pierwszy 130001
Gdzie przekazywane są wiadomości dla mps-dialcom24
	ODP: bean class="pl.avantis.mpsml.protocol.impl.EndpointDestination">
					<constructor-arg index="0" value="https://secure.przelewy24.pl/cf/avantis_soap.php"/>
								</bean>
Na jaki adres komunikuje się partner mps-mediacontact
	ODP: 4217b2ed245dbcacd65b3b017a14b67d
Z użyciem filtru:
project = HL and summary ~ "fatalService" AND summary ~ mps ORDER BY updated DESC
Należy

wybrać jednej z ostatnich Helpline np. [arh+] [fatalService] 110104 mps-eurocast
zweryfikować w logach co było przyczyną awarii
[user@dniu]$ pwd
/mnt/logs
jak przebiegała komunikacja
wskazać błędy w logach
	ODP:
	2018-11-01 01:33:22,117 | ERROR | mps-eurocast                             | 113   | [33181121947] | Error dispatching outgoing message
	# błąd znaleźony w logu
	2018-11-01 01:35:27,517 DEBUG [HTTPSender] [] Enter:  HTTPSender::invoke
	2018-11-01 01:35:27,559 DEBUG [HTTPSender] [] java.net.ConnectException: Połączenie odrzucone (Connection refused)
	2018-11-01 01:35:27,560 ERROR [MPSv2OutgoingAdapter] [] Unexpected error while sending message, rethrown as Processing exceptionAxisFault
	 faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.userException
	  faultSubcode:
	   faultString: java.net.ConnectException: Połączenie odrzucone (Connection refused)
	    faultActor:
	     faultNode:
	      faultDetail:
	              {http://xml.apache.org/axis/}stackTrace:java.net.ConnectException: Połączenie odrzucone (Connection refused)
		              at java.net.PlainSocketImpl.socketConnect(Native Method)
			              at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:344)

	# błąd z loga adaptera
		/mnt/logs/srv2mp/2018-11-01/mpservices_comm_mpsml-adapters.log.2018-11-01.bz2

[4.3]


Dzień dobry,
otrzymujemy błąd przy próbie komunikacji z państwa serwerem , przy wywołaniu adresu http://www.mojesmsy.pl/avantis-sms.php zwaca nam błąd 404

URL:http://www.mojesmsy.pl/avantis-sms.php
Data wysyłki: [dd-mm-yyyy hh:mm]
Opis Problemu: brak komunikacji z serwerem, błąd 404

Prosiłbym o analize problemu po państwa stronie.
Pozdrawiam K.W. D.V.
Dzień dobry,
mamy problem z brakiem bilowań po [rejestracji/subskrypcji]. Poniżej załączam szczegółowe informacje.

LA: BADOO
Data wysyłki: [dd-mm-yyyy hh:mm]
Przykład z logu: xxxxxx
Opis Problemu: brak bilowań

Prosiłbym o analize po państwa stronie.
Pozdrawiam K.W. D.V.
Dzień Dobry,
Przesyłam zgodnie z proźbą ,z rozmowy telefonicznej ,przysyłam sczegułowe informacje o awarii.

2012-10-09 13:13:13 - 2012-10-09 13:20:29 - rozwiązywanie problemów z aplikają Java na hoście
2012-10-09 14:55:26 - 2012-10-09 15:15:30 - reboot kernela na kolorowym hoście

Data wysyłki: [dd-mm-yyyy hh:mm]

Dziękuje za cierpliwość i życze miłego dnia.
Pozdrawiam K.W. D.V.

Technical Contact
Email:support@t-mobile.pl
crm-2081
LVL3 - Support TMobile
Kontakt telefoniczny należy wykorzystać w momencie niedostępności Panelu Klienta
Kontak mailowy używamy wyłącznie w momencie nie działania panelu i niemożliwości dodzwonienia się - operator nie przyjmuje oficjalnie zgłoszeń mailowy.

serwis tvp
CRM-3264 wykorzystujemy w przypadku nie działania API TVP
support_online@tvp.pl

CRM-428
Mediaplazza [MPS]

Dzień dobry,
zaobserwowalismy że nie dziala u was serwer, pukamy na adres http://www.mojesmsy.pl/avantis-sms.php i zwracacie nam blod 404.
Prosimy o naprawę tej sytuacji.

----POP
Dzień dobry,
otrzymujemy błąd przy próbie komunikacji z państwa serwerem , przy wywołaniu adresu http://www.mojesmsy.pl/avantis-sms.php zwaca nam błąd 404

URL:http://www.mojesmsy.pl/avantis-sms.php
Data wysyłki: [dd-mm-yyyy hh:mm]
Opis Problemu: brak komunikacji z serwerem, błąd 404

Prosiłbym o analize problemu po państwa stronie.
Pozdrawiam K.W. D.V.

---------------------------------

Cześć,
nie wyszła wysyłka subskrypcji BADOO, proszę o podanie przyczyny i naprawe problemu, proszę o jak najszybszy kontakt.
Chę przypomnieć że ten problem wystąpił już wielokrotnie i może to być ten sam powód co w zesły poniedziałek.

-----POP
Dzień dobry,
mamy problem z brakiem bilowań po [rejestracji/subskrypcji]. Poniżej załączam szczegółowe informacje.

LA: BADOO
Data wysyłki: [dd-mm-yyyy hh:mm]
Przykład z logu: xxxxxx
Opis Problemu: brak bilowań

Prosiłbym o analize po państwa stronie.
Pozdrawiam K.W. D.V.

------------------------------------



Witam,

Przepraszam za tak późną odpowiedź, ale tak jak w rozmowie telefonicznej zawieruszył się email.
Ramy czasowe awarii to :

2012-10-09 13:13:13 - 2012-10-09 13:20:29 < - pierwszy etap
2012-10-09 14:55:26 - 2012-10-09 15:15:30 < - drugi etap

W pierwszym etapie były problemy z javą na hoście zaś w drugim poleciał kernel panic na korowym hoście.


----ODP
Dzień Dobry,
Przesyłam zgodnie z proźbą ,z rozmowy telefonicznej ,przysyłam sczegułowe informacje o awarii.

2012-10-09 13:13:13 - 2012-10-09 13:20:29 - rozwiązywanie problemów z aplikają Java na hoście
2012-10-09 14:55:26 - 2012-10-09 15:15:30 - reboot kernela na kolorowym hoście

Data wysyłki: [dd-mm-yyyy hh:mm]

Dziękuje za cierpliwość i życze miłego dnia.
Pozdrawiam K.W. D.V.

[5.4]

	2.  partnerzy DP HA powinni być informowani o awarii
		istnieje problem u jednego z operatorów lub całego serwisu (brak liczby zbilowanych)
		istnieje problem dla konkretnego MSISDNa (brak zbilowania dla danego serwisu o określonym czasie)

[5.2]
A. Dla serwisu VIP 60798 należy wyciągnąć z DB
	1 ID Serwisu (MTSP.SERVICE)
	2 ID Serwisu dla każdego operatora (MTSP.SERVICE_OPERATOR)
	3 ID Ostatnich 6 subskrypcji (MTSP.SUBSCRIPRION_OPERATOR)
	4 Treść ostatnich 6 subskrypcji (MTSP.SMS)
	5 Ilość rejestracji, per dzień, w rozłożeniu na Source (MTSP.SUBSCRIBER)
	6 Ilość bilowań w ostatniej subskrypcji (SQL Bilowania po subskrypcji)
	7 Porównać ostatnie 2 bilowania po subskrypcji, z uwzględnieniem tydzień do tygodnia
B. Dla serwisu PRE 60798 należy wyciągnąć z DB
	1 Ilość bilowań po rejestracji, per dzień, per status (wynik powinien zawierać również nazwę serwisu oraz LA) (MTSP.BILLED_MSISDN)
	2 Odnaleźć opiekuna biznesowego (MTSP.SERVICE, MTSP.SERVICE_BUSINESS_OWNER, CP_CMS.BUSINESS_OWNERS)
C. Z każdej Polskiej bramki MT wyciągnąć XML ładującego kontent dla serwisu PRE


----ODO
||Operator_prefix||
|T-mobile (SC)|
|Plus|782424565|141,44 zł|
|Orange|519762823|158,77 zł|
|Play|531162757|110,41 zł|
|Heyah|880372096|108,56 zł|
|Virgin Mobile|736003642|59,06 zł|

1. select id ,name from MTSP.service where name = 'VIP_60798' ;
2. select operator_prefix from MTSP.service_operator where service_id = '10254' ;
3. select * from MTSP.service a join mtsp.service_operator b on a.id = b.service_id
                    join MTSP.subscription_operator c on c.service_operator_id = b.id
                    where name = 'VIP_60798'
                    and rownum < 6 ;
4. select d.text , c.send_date
from MTSP.service a join mtsp.service_operator b on a.id = b.service_id
                    join MTSP.subscription_operator c on c.service_operator_id = b.id
                    join MTSP.sms d on c.id = d.subscr_oper_id
                    where name = 'VIP_60798'
                    and rownum < 6 ORDER BY c.send_date DESC;
5.select trunc (c.update_date ,'day') as data , count(c.msisdn) as rejestracje, c.source , a.name
                    from MTSP.service a
                    join MTSP.service_operator b on a.id = b.service_id
                    join MTSP.subscriber c on b.id = c.service_oper_id
                    where name in 'VIP_60798'
                    and status = 'REGISTERED'
                    and c.update_date < TO_DATE('2018-12-15', 'YYYY-MM-DD')
                    group by trunc (c.update_date ,'day') , c.source   , a.name
                    order by data desc;
6.
select * from (
			select a.name , trunc(c.billed_date , 'day') as data_ost_sub ,count(c.msisdn) as ilość_bilowań
					from MTSP.service a
					join MTSP.service_operator b on b.service_id = a.id
					join MTSP.billed_msisdn c on c.service_oper_id = b.id
					where name in 'VIP_60798'
					group by trunc (c.billed_date ,'day') , a.name
					order by data_ost_sub desc ) where rownum <=1 ;
7.
2.2
	CP_CMS.BUSINESS_OWNERS -
	MTSP.SERVICE_BUSINESS_OWNER -
	MTSP.SERVICE -

3.1
ID: 3874037
Address: http://msgw-ws.centertel.pl:8180/services/msgw
Encoding: UTF-8
Content-Type: text/xml
Headers: {SOAPAction=["http://msgw-ws.centertel.pl/GetDeliveryStatus"], Accept=[*/*]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetDeliveryStatus xmlns="http://msgw-ws.centertel.pl"><providerId>AVANTIS</providerId><providerPass
word>G8VrjpRH</providerPassword><LA>60798</LA><serviceId>PRE</serviceId><deliveryDateFrom>2018-12-20T00:01:13.254+01:00</deliveryDateFrom><deliveryDateTo>2018-12-21T00:00:13.254+01:00</deliv
eryDateTo><reportDateFrom>2018-12-20T23:57:47.395+01:00</reportDateFrom><reportDateTo>2018-12-21T00:00:13.254+01:00</reportDateTo><transactionId>25715426560</transactionId></GetDeliveryStatu
s></soap:Body></soap:Envelope>



ID: 50707
Address: http://ipsec.plusgsm.pl/MTManagerWeb/services/MTManagerWS
Encoding: UTF-8
Http-Method: POST
Content-Type: text/xml
Headers: {Accept=[*/*], Authorization=[Basic d3NQTVRNX0FWQU5USVM6MUAzYUFAQU5JUw==], SOAPAction=["requestSMSDelivery"]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><requestSMSDelivery xmlns="http://manager.mt.polkomtel"
xmlns:ns2="http://model.common.mt.polkomtel"><serviceMsisdn>60798</serviceMsisdn><serviceName>PRE</serviceName>
<msisdns><ns2:items>48663268082</ns2:items></msisdns><messages><ns2:items>Zamowienie Premium Czlonkostwa dokonane pomyslnie.
W razie problemu prosze pisac na info@erodate.pl. Zyczymy milych doswiadczen oraz intrygujacych przygod!</ns2:items></messages>
<additionalParams><ns2:properties><ns2:name>START_TIME</ns2:name><ns2:value>20181221141116</ns2:value></ns2:properties><ns2:properties>
<ns2:name>TIME_LIMIT</ns2:name><ns2:value>21600</ns2:value></ns2:properties></additionalParams></requestSMSDelivery></soap:Body></soap:Envelope>

ID: 1094
Address: https://content.t-mobile.pl/b2b/documentUpload
Encoding: UTF-8
Content-Type: text/xml
Headers: {SOAPAction=[""], Authorization=[Basic QVZBTlRJUzo1MDQyMDg5Nzg=], Accept=[*/*]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><uploadDocument xmlns="B2BManagerBean" xmlns:ns2="java:language_builtins.lang"><string>NULL</string>
<strings><ns2:string>&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;article id="INFO-19273ecc8c3d4749ae663038039a749f"&gt;
    &lt;metadata&gt;
        &lt;source&gt;Avantis_dotcom21122018&lt;/source&gt;
        &lt;validFrom&gt;2018-12-21T01:08:25.326+01:00&lt;/validFrom&gt;
        &lt;validTo&gt;2018-12-21T09:08:25.326+01:00&lt;/validTo&gt;
    &lt;/metadata&gt;
    &lt;title&gt;dotcom21122018&lt;/title&gt;
    &lt;abstract&gt;DOTCOM TEST&lt;/abstract&gt;
    &lt;sms&gt;
        &lt;content&gt;DOTCOM TEST&lt;/content&gt;
    &lt;/sms&gt;
&lt;/article&gt;
</ns2:string></strings><booleanVal>true</booleanVal></uploadDocument></soap:Body></soap:Envelope>

ID: 938
Address: http://195.69.126.64:80/P4SmsMTConsole/services
Encoding: UTF-8
Content-Type: text/xml
Headers: {SOAPAction=[""], Authorization=[Basic YXY6QXZhbnQyMDE4Iw==], Accept=[*/*]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><SaveSmsRequest xmlns="http://vamm.drq.pl/vasp/schemas"><Sms><VasId>W7SV6</VasId><SendDate>2018-12-21 08:00:00</SendDate><Active>true</Active><SmsType>text</SmsType><Text>Jesli zainstalowane programy lub firmware są nieaktualne tworzą okazję dla włamywaczy dlatego przeprowadzaj aktualizacje</Text></Sms></SaveSmsRequest></soap:Body></soap:Envelope>


##########na 7 , 2.1 , 2.2
-- raport bilowań z 2 ostatnich tygodni
select serop.gateway_service_name, serop.operator_la, count(bm.msisdn) as bilowania, bm.status, trunc(sop.scheduled_to, 'IW')as week
from mtsp.service_operator serop, mtsp.service s , mtsp.subscription sub, mtsp.subscription_operator sop , mtsp.billed_msisdn bm
where s.id = serop.service_id
and s.name like 'VIP%'
and serop.gateway_service_name not like '%SMS%'
and sub.id = sop.subscription_id
and serop.id = sop.service_operator_id
and bm.sub_operator_id = sop.id
and serop.operator_la = '60798'
and bm.status = 20
and sop.scheduled_to BETWEEN sysdate-19 AND sysdate-5       /*aktualny początek i koniec tygodnia*/
group by  trunc(sop.scheduled_to, 'IW'), serop.gateway_service_name, serop.operator_la, bm.status
order by trunc(sop.scheduled_to, 'IW') desc

--Ilość bilowań po rejestracji, per dzień, per status  (nazwe serwisu oraz LA) (MTSP.BILLED_MSISDN)
select bm.billed_date, serop.gateway_service_name, serop.operator_la, serop.operator_prefix, bm.msisdn, bm.status
from mtsp.service_operator serop, mtsp.service s, mtsp.billed_msisdn bm
where s.id = serop.service_id
and serop.gateway_service_name like '%PRE%'
and serop.operator_la = 60798
and bm.status = 20
--and serop.operator_prefix = '26002'
and bm.billed_date >= sysdate-2
and bm.service_oper_id = serop.id
--group by bm.billed_date, serop.gateway_service_name, serop.operator_la, serop.operator_prefix, bm.status
order by bm.billed_date;

--Ilość bilowań po rejestracji, per itp itd + business_owner
select bm.billed_date, serop.gateway_service_name, serop.operator_la, serop.operator_prefix, bm.msisdn, bm.status, cp.name
from mtsp.service_operator serop, mtsp.service s, mtsp.billed_msisdn bm, MTSP.SERVICE_BUSINESS_OWNER bo,
CP_CMS.BUSINESS_OWNERS cp
where s.id = serop.service_id
and bo.BUSINESS_OWNER_ID = cp.BUSINESS_OWNER_ID
and serop.gateway_service_name like '%PRE%'
and serop.operator_la = 60798
and bm.status = 20
and bm.billed_date >= sysdate-2
and bm.service_oper_id = serop.id
order by bm.billed_date;

#######################



[5.14] SAP Report Platform

	1. w jaki sposób jest sprawdzane działanie wysyłania raportu mailowego
	2. Wklej logi z wysyłania maila

	1.Check sprawdza czy w ciągu ostatniego dnia zostały zaciągnięte dane do schematu SAPAD na którym bazuje raport
		Check pobiera wiadomości z x ostatnich minut (parametr lastMinute) z poczty o loginie (email) i haśle (password).
		Skrzynka ta musi być założona na mail.avantis.pl. Następnie sprawdzane są wszystkie kryteria, jakie muszą być spełnione dla maila.
		Jeśli przynajmniej jeden mail spełnia te kryteria check zwraca OK.
		Kryteria są podawane w parametrach subject , text, attachment, sender. Na końcu wiadomości starsze niż 24 są usuwane

	2. 	Dec 27 14:30:27 mail smtpd[3156]: smtp-in: Accepted message 8857e7bb on session ab250a039c4dccc4: from=<no-reply-sap@avantis.pl>, to=<sap_monitoring@digitalvirgo.pl>, size=918, ndest=1, proto=ESMTP
		Dec 27 14:30:27 mail smtpd[3156]: smtp-in: Closing session ab250a039c4dccc4
		Dec 27 14:30:27 mail smtpd[3156]: smtp-out: Connecting to tls://52.30.236.147:25 (ec2-52-30-236-147.eu-west-1.compute.amazonaws.com) on session ab250a0ccbdebaa8...
		Dec 27 14:30:27 mail smtpd[3156]: smtp-out: Connected on session ab250a0ccbdebaa8
		Dec 27 14:30:27 mail smtpd[3156]: smtp-out: Started TLS on session ab250a0ccbdebaa8: version=TLSv1.2, cipher=ECDHE-RSA-AES256-GCM-SHA384, bits=256
		Dec 27 14:30:27 mail smtpd[3156]: smtp-out: Server certificate verification succeeded on session ab250a0ccbdebaa8
		Dec 27 14:30:27 mail smtpd[3156]: relay: Ok for 8857e7bb0d1320f9: session=ab250a0ccbdebaa8, from=<no-reply-sap@avantis.pl>, to=<sap_monitoring@digitalvirgo.pl>,
		rcpt=<->, source=10.168.202.220, relay=52.30.236.147 (ec2-52-30-236-147.eu-west-1.compute.amazonaws.com), delay=0s, stat=250 Ok 01020167efdbeec1-9f665630-bb37-4049-9dee-b83914d872f8-000000


[5.7] Czater

rejestracja
{code}
018-12-28 08:39:02,566 | INFO  | InternalServiceHelperImpl | RMI TCP Connection(68473)-10.168.202.143 | Changing registration status to 'REGISTERED' for serviceMsisdn=[60255] , serviceName=[CZATER] , msisdn=[48782424565]
2018-12-28 08:39:02,566 | INFO  | InternalServiceHelperImpl | RMI TCP Connection(68473)-10.168.202.143 | Returning SubscriberStatusRequest{msisdn='48782424565', updateDate=Fri Dec 28 08:39:02 CET 2018, status=10, operator=26001, serviceName='CZATER', largeAccount='60255', cause='null', properties={source=SMS}}
{code}
nick
{code}
2018-12-28 08:43:57,211 INFO  [Old I/O client worker ([id: 0xe8a08013, 0.0.0.0/0.0.0.0:34186 => smsc_plus11/212.2.118.11:9971])] [CIMDFrameDecoder] [] Raw frame being read: 20:130     021:80750       023:48782424565 060:181228084357        033:Marian123   052:0   030:0   026:260011602123519     028:+48601000321        58 on channel: [id: 0xe8a08013, 0.0.0.0/0.0.0.0:34186 => smsc_plus11/212.2.118.11:9971]
2018-12-28 08:43:57,212 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Looking for a message with a key: 48782424565_null_181228084357
2018-12-28 08:43:57,217 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents before CIMD special characters conversion: Marian123
2018-12-28 08:43:57,217 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents after CIMD special characters conversion: Marian123
{code}
płeć
{code}
2018-12-28 08:43:58,650 INFO  [RMI TCP Connection(943)-10.168.202.75] [CIMDFrameEncoder] [33319186352] Raw frame being sent: 03:083     021:48782424565 033:MARIAN123.4, prosimy podaj swoja plec - jesli jestes dziewczyna odpisz w SMSie: K, jesli jestes chlopakiem odpisz: M.        on channel: [id: 0xe8a08013, 0.0.0.0/0.0.0.0:34186 => smsc_plus11/212.2.118.11:9971]
2018-12-28 08:43:58,804 INFO  [Old I/O client worker ([id: 0xe8a08013, 0.0.0.0/0.0.0.0:34186 => smsc_plus11/212.2.118.11:9971])] [CIMDFrameDecoder] [] Raw frame being read: 53:083     021:48782424565 060:181228084405        A9 on channel: [id: 0xe8a08013, 0.0.0.0/0.0.0.0:34186 => smsc_plus11/212.2.118.11:9971]
2018-12-28 08:44:13,492 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Looking for a message with a key: 48782424565_null_181228084413
2018-12-28 08:44:13,497 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents before CIMD special characters conversion: M
2018-12-28 08:44:13,497 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents after CIMD special characters conversion: M
{code}
wiek
{code}
2018-12-28 08:44:37,083 INFO  [upstream-traffic-executor-6] [CIMDGateway] [] Looking for a message with a key: 48782424565_null_181228084437
2018-12-28 08:44:37,087 INFO  [upstream-traffic-executor-6] [CIMDGateway] [] Text SMS contents before CIMD special characters conversion: 66
2018-12-28 08:44:37,088 INFO  [upstream-traffic-executor-6] [CIMDGateway] [] Text SMS contents after CIMD special characters conversion: 66
{cpde}
lista kontaktów
{code}
2018-12-28 08:44:57,198 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Looking for a message with a key: 48782424565_null_181228084457
2018-12-28 08:44:57,203 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents before CIMD special characters conversion: Lista
2018-12-28 08:44:57,203 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents after CIMD special characters conversion: Lista
{code}
wybrany
{code}
2018-12-28 08:45:33,624 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Looking for a message with a key: 48782424565_null_181228084533
2018-12-28 08:45:33,629 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents before CIMD special characters conversion: 4
2018-12-28 08:45:33,629 INFO  [upstream-traffic-executor-5] [CIMDGateway] [] Text SMS contents after CIMD special characters conversion: 4
{code}
ustanowienie wspunegi czatu
{code}
2018-12-28 10:03:15,944 INFO  [RMI TCP Connection(956)-10.168.202.75] [Messaging] [] Message delivered: id=33319308269, payload=TextSMS{sender='80750', recipient='48782424565', sendDate=Fri Dec 28 10:03:15 CET 2018, externalSendDate=null, deliveryDate=null, validityDate=n
ull, payloadType=TEXT_SMS, operator=POLAND_PLUS, masterOperator=POLAND_PLUS, mobileTerminated=false, payloadDirection=OUT, text='Zrezygnowales z udzialu w serwisie! Jesli chcesz ponownie wejsc do zabawy - wyslij SMS o tresci CZAT pod numer 80750.', dataCodingScheme=0, par
tsNumber=1}, role=REQUEST
{code}
zakończenie subskrypcji
{code}
2018-12-28 10:03:15,950 INFO  [RMI TCP Connection(956)-10.168.202.75] [CIMDFrameEncoder] [33319308269] Raw frame being sent: 03:239     021:48782424565 033:Zrezygnowales z udzialu w serwisie! Jesli chcesz ponownie wejsc do zabawy - wyslij SMS o tresci CZAT pod numer 80750
.        on channel: [id: 0xe8a08013, 0.0.0.0/0.0.0.0:34186 => smsc_plus11/212.2.118.11:9971]
{code}

[4.6] Zapoznanie się z narzędziami DNIU

Czym jest DBSessionMonitor oraz do czego służy
	- Aplikacja służy do ustalania jakie sesje są ustanowione na bazie danych Oracle
Gdzie graficznie można odnaleźć historię MSISDN
	- w DB oracle
Z jakiego narzędzia wysyłane są tzw Bulki
	- bulkman
Gdzie znajduje się lista IPSec
 	- na orionie
Czego należy użyć aby zweryfikować do jakiego operatora należy MSISDN
	- na hoście dniu jest polecenie "siec"
Czym jest logmover
	- Logmover jest to skrypt do szybkiego i sprawnego przenoszenia logów z hosta produkcyjnego na hosta DNIU (mpdevelop:host ~/logmover/)
restart-mesos-apps.py
	- skonteneryzowane usługi restrtujemy przez dc/os
Omówienie logfind
	- szukanie logów
